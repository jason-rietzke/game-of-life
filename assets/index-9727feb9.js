var Be=Object.defineProperty;var Ce=(h,f,i)=>f in h?Be(h,f,{enumerable:!0,configurable:!0,writable:!0,value:i}):h[f]=i;var Ie=(h,f)=>()=>(f||h((f={exports:{}}).exports,f),f.exports);var C=(h,f,i)=>(Ce(h,typeof f!="symbol"?f+"":f,i),i);var ze=Ie((Fe,$)=>{(async()=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(t){if(t.ep)return;t.ep=!0;const o=n(t);fetch(t.href,o)}})();const h="/game-of-life/assets/game_of_life_bg-feda1844.wasm",f=async(e={},n)=>{let r;if(n.startsWith("data:")){const t=n.replace(/^data:.*?base64,/,"");let o;if(typeof Buffer=="function"&&typeof Buffer.from=="function")o=Buffer.from(t,"base64");else if(typeof atob=="function"){const l=atob(t);o=new Uint8Array(l.length);for(let a=0;a<l.length;a++)o[a]=l.charCodeAt(a)}else throw new Error("Cannot decode base64-encoded data URL");r=await WebAssembly.instantiate(o,e)}else{const t=await fetch(n),o=t.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&o.startsWith("application/wasm"))r=await WebAssembly.instantiateStreaming(t,e);else{const l=await t.arrayBuffer();r=await WebAssembly.instantiate(l,e)}}return r.instance.exports};let i;function H(e){i=e}const g=new Array(128).fill(void 0);g.push(void 0,null,!0,!1);function F(e){return g[e]}let v=g.length;function K(e){e<132||(g[e]=v,v=e)}function X(e){const n=F(e);return K(e),n}const Y=typeof TextDecoder>"u"?(0,$.require)("util").TextDecoder:TextDecoder;let O=new Y("utf-8",{ignoreBOM:!0,fatal:!0});O.decode();let T=null;function x(){return(T===null||T.byteLength===0)&&(T=new Uint8Array(i.memory.buffer)),T}function I(e,n){return e=e>>>0,O.decode(x().subarray(e,e+n))}let A=null;function L(){return(A===null||A.byteLength===0)&&(A=new Int32Array(i.memory.buffer)),A}function G(e){v===g.length&&g.push(g.length+1);const n=v;return v=g[n],g[n]=e,n}let z=0;const J=typeof TextEncoder>"u"?(0,$.require)("util").TextEncoder:TextEncoder;let M=new J("utf-8");const Q=typeof M.encodeInto=="function"?function(e,n){return M.encodeInto(e,n)}:function(e,n){const r=M.encode(e);return n.set(r),{read:e.length,written:r.length}};function V(e,n,r){if(r===void 0){const c=M.encode(e),k=n(c.length,1)>>>0;return x().subarray(k,k+c.length).set(c),z=c.length,k}let t=e.length,o=n(t,1)>>>0;const l=x();let a=0;for(;a<t;a++){const c=e.charCodeAt(a);if(c>127)break;l[o+a]=c}if(a!==t){a!==0&&(e=e.slice(a)),o=r(o,t,t=a+e.length*3,1)>>>0;const c=x().subarray(o+a,o+t),k=Q(e,c);a+=k.written}return z=a,o}function Z(e){return()=>{throw new Error(`${e} is not defined`)}}const P=Object.freeze({Dead:0,0:"Dead",Alive:1,1:"Alive"});class S{static __wrap(n){n=n>>>0;const r=Object.create(S.prototype);return r.__wbg_ptr=n,r}__destroy_into_raw(){const n=this.__wbg_ptr;return this.__wbg_ptr=0,n}free(){const n=this.__destroy_into_raw();i.__wbg_universe_free(n)}static new(n,r){const t=i.universe_new(n,r);return S.__wrap(t)}width(){return i.universe_width(this.__wbg_ptr)>>>0}height(){return i.universe_height(this.__wbg_ptr)>>>0}cells(){return i.universe_cells(this.__wbg_ptr)}render(){let n,r;try{const l=i.__wbindgen_add_to_stack_pointer(-16);i.universe_render(l,this.__wbg_ptr);var t=L()[l/4+0],o=L()[l/4+1];return n=t,r=o,I(t,o)}finally{i.__wbindgen_add_to_stack_pointer(16),i.__wbindgen_free(n,r,1)}}randomize(){i.universe_randomize(this.__wbg_ptr)}clear(){i.universe_clear(this.__wbg_ptr)}toggle_cell(n,r){i.universe_toggle_cell(this.__wbg_ptr,n,r)}tick(){i.universe_tick(this.__wbg_ptr)}}function ee(){const e=new Error;return G(e)}function te(e,n){const r=F(n).stack,t=V(r,i.__wbindgen_malloc,i.__wbindgen_realloc),o=z;L()[e/4+1]=o,L()[e/4+0]=t}function ne(e,n){let r,t;try{r=e,t=n,console.error(I(e,n))}finally{i.__wbindgen_free(r,t,1)}}function re(e){X(e)}const oe=typeof Math.random=="function"?Math.random:Z("Math.random");function ie(e,n){throw new Error(I(e,n))}URL=globalThis.URL;const _=await f({"./game_of_life_bg.js":{__wbg_new_abda76e883ba8a5f:ee,__wbg_stack_658279fe44541cf6:te,__wbg_error_f851667af71bcfc6:ne,__wbindgen_object_drop_ref:re,__wbg_random_5f61cd0d6777a993:oe,__wbindgen_throw:ie}},h),j=_.memory,se=_.__wbg_universe_free,le=_.universe_new,ae=_.universe_width,ce=_.universe_height,_e=_.universe_cells,fe=_.universe_render,de=_.universe_randomize,ue=_.universe_clear,he=_.universe_toggle_cell,ge=_.universe_tick,we=_.__wbindgen_add_to_stack_pointer,me=_.__wbindgen_free,be=_.__wbindgen_malloc,pe=_.__wbindgen_realloc,ye=Object.freeze(Object.defineProperty({__proto__:null,__wbg_universe_free:se,__wbindgen_add_to_stack_pointer:we,__wbindgen_free:me,__wbindgen_malloc:be,__wbindgen_realloc:pe,memory:j,universe_cells:_e,universe_clear:ue,universe_height:ce,universe_new:le,universe_randomize:de,universe_render:fe,universe_tick:ge,universe_toggle_cell:he,universe_width:ae},Symbol.toStringTag,{value:"Module"}));H(ye);const s=10,ve=window.innerWidth/s,Ee=window.innerHeight/s,ke="#393a3c",Te="#151618",xe="#94a8ff",b=document.getElementById("game-of-life-canvas");if(!b)throw new Error("Canvas not found");const B=document.getElementById("play-toggle");if(!B)throw new Error("PlayToggle not found");const R=document.getElementById("next");if(!R)throw new Error("Next not found");const W=document.getElementById("randomizer");if(!W)throw new Error("Randomizer not found");const D=document.getElementById("clear");if(!D)throw new Error("Clear not found");let E=null;const Ae=()=>E===null,Le=()=>{B.textContent="\u23F8",q()},Me=()=>{B.textContent="\u25B6",E&&cancelAnimationFrame(E),E=null};B.addEventListener("click",()=>Ae()?Le():Me()),R.addEventListener("click",()=>{w.tick(),p(),y()}),W.addEventListener("click",()=>{w.randomize(),p(),y()}),D.addEventListener("click",()=>{w.clear(),p(),y()});const w=S.new(ve,Ee);w.randomize();const u=w.width(),m=w.height();b.height=(s+1)*m+1,b.width=(s+1)*u+1;const U="2d",d=b.getContext(U);if(!d)throw new Error(`Context ${U} not found`);const q=()=>{Se.render(),w.tick(),p(),y(),E=requestAnimationFrame(q)},p=()=>{d.beginPath(),d.strokeStyle=ke;for(let e=0;e<=u;e++)d.moveTo(e*(s+1)+1,0),d.lineTo(e*(s+1)+1,(s+1)*m+1);for(let e=0;e<=m;e++)d.moveTo(0,e*(s+1)+1),d.lineTo((s+1)*u+1,e*(s+1)+1);d.stroke()},y=()=>{const e=w.cells(),n=new Uint8Array(j.buffer,e,u*m);d.beginPath(),d.fillStyle=xe;for(let r=0;r<m;r++)for(let t=0;t<u;t++){const o=N(r,t);n[o]===P.Alive&&d.fillRect(t*(s+1)+1,r*(s+1)+1,s,s)}d.fillStyle=Te;for(let r=0;r<m;r++)for(let t=0;t<u;t++){const o=N(r,t);n[o]===P.Dead&&d.fillRect(t*(s+1)+1,r*(s+1)+1,s,s)}d.stroke()},N=(e,n)=>e*u+n;p(),y(),b.addEventListener("click",e=>{const n=b.getBoundingClientRect(),r=b.width/n.width,t=b.height/n.height,o=(e.clientX-n.left)*r,l=(e.clientY-n.top)*t,a=Math.min(Math.floor(l/(s+1)),m-1),c=Math.min(Math.floor(o/(s+1)),u-1);w.toggle_cell(a,c),p(),y()});const Se=new class{constructor(){C(this,"fps");C(this,"frames");C(this,"lastFrameTimeStamp");const e=document.getElementById("fps");if(!e)throw new Error("FPS not found");this.fps=e,this.frames=[],this.lastFrameTimeStamp=performance.now()}render(){const e=performance.now(),n=e-this.lastFrameTimeStamp;this.lastFrameTimeStamp=e;const r=1/n*1e3;this.frames.push(r),this.frames.length>100&&this.frames.shift();let t=1/0,o=-1/0,l=0;for(let c=0;c<this.frames.length;c++)l+=this.frames[c],t=Math.min(this.frames[c],t),o=Math.max(this.frames[c],o);let a=l/this.frames.length;this.fps.textContent=["Frames per Second:",`${u}*${m}=${u*m} cells`,`latest = ${Math.round(r)}`,`avg of last 100 = ${Math.round(a)}`,`min of last 100 = ${Math.round(t)}`,`max of last 100 = ${Math.round(o)}`].join(`
`)}}})()});export default ze();
